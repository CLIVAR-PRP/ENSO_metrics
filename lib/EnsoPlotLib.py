# -*- coding:UTF-8 -*-
#
# Define ENSO metrics plots
#
from numpy import arange as NUMPYarange
# ENSO_metrics functions
from EnsoCollectionsLib import defCollection
from KeyArgLib import DefaultArgValues


dict_colorbar = {
    'amplitude': 'amp',
    'anomalies': 'balance',
    'PR': 'rain',
    'SST': 'thermal',
}

dict_label = {
    'amplitude': [round(ii, 1) for ii in NUMPYarange(0, 2.1, 0.5)],
    'amplitude5': list(range(0, 6, 1)),
    'amplitude10': [round(ii, 1) for ii in NUMPYarange(0, 10.1, 2.5)],
    'amplitude15': list(range(0, 16, 5)),
    'amplitude60': list(range(0, 61, 20)),
    'PR': list(range(0, 13, 4)),
    'PRA': [round(ii, 1) for ii in NUMPYarange(-1, 1.1, 0.5)],
    'REG03': [round(ii, 1) for ii in NUMPYarange(-0.3, 0.35, 0.1)],
    'REG05': [round(ii, 2) for ii in NUMPYarange(-0.5, 0.55, 0.25)],
    'REG12': [round(ii, 1) for ii in NUMPYarange(-1.2, 1.4, 0.6)],
    'REG2': list(range(-2, 3, 1)),
    'REG25': [round(ii, 1) for ii in NUMPYarange(-2.5, 2.6, 1.0)],
    'REG3': list(range(-3, 4, 1)),
    'REG4': list(range(-4, 5, 1)),
    'REG5': [round(ii, 1) for ii in NUMPYarange(-5, 6, 2.5)],
    'REG20': list(range(-20, 25, 10)),
    'REG30': list(range(-30, 35, 15)),
    'REG50': list(range(-50, 55, 25)),
    'REG60': list(range(-60, 65, 30)),
    'REG80': list(range(-80, 85, 40)),
    'SKEW': [round(ii, 1) for ii in NUMPYarange(-1.5, 1.6, 0.5)],
    'dSST': list(range(-2, 3, 1)),
    'SST': list(range(21, 31, 3)),
    'SSTA': [round(ii, 1) for ii in NUMPYarange(-1, 1.1, 0.5)],
    'TAUX': list(range(-100, 110, 50)),
}

plot_parameters = {
    'BiasPrLatRmse': {
        'netcdf_variables': ['pr_lat__', 'pr_map__'],
        'diagnostic': {
            'plot_type': 'curve',
            'nbr_panel': 1,
            'title': 'Mean PR',
            'varpattern': 'pr_lat__',
            'xname': 'latitude',
            'yname': 'PR',
        },
        'dive_down01': {
            'plot_type': 'map',
            'nbr_panel': 2,
            'colorbar': dict_colorbar['PR'],
            'label': dict_label['PR'],
            "maskland": True,
            'title': ['Mean PR', 'Mean PR'],
            'varpattern': 'pr_map__',
            'xname': 'longitude',
            'yname': 'latitude',
            'zname': 'PR',
        },
    },
    'BiasPrLonRmse': {
        'netcdf_variables': ['pr_lon__', 'pr_map__'],
        'diagnostic': {
            'plot_type': 'curve',
            'nbr_panel': 1,
            'title': 'Mean PR',
            'varpattern': 'pr_lon__',
            'xname': 'longitude',
            'yname': 'PR',
        },
        'dive_down01': {
            'plot_type': 'map',
            'nbr_panel': 2,
            'colorbar': dict_colorbar['PR'],
            'label': dict_label['PR'],
            "maskland": True,
            'title': ['Mean PR', 'Mean PR'],
            'varpattern': 'pr_map__',
            'xname': 'longitude',
            'yname': 'latitude',
            'zname': 'PR',
        },
    },
    'BiasPrRmse': {
        'netcdf_variables': ['pr_map__'],
        'diagnostic': {
            'plot_type': 'map',
            'nbr_panel': 2,
            'colorbar': dict_colorbar['PR'],
            'label': dict_label['PR'],
            "maskland": True,
            'title': ['Mean PR', 'Mean PR'],
            'varpattern': 'pr_map__',
            'xname': 'longitude',
            'yname': 'latitude',
            'zname': 'PR',
        },
    },
    'BiasSstLatRmse': {
        'netcdf_variables': ['sst_lat__', 'sst_map__'],
        'diagnostic': {
            'plot_type': 'curve',
            'nbr_panel': 1,
            'title': 'Mean SST',
            'varpattern': 'sst_lat__',
            'xname': 'latitude',
            'yname': 'SST',
        },
        'dive_down01': {
            'plot_type': 'map',
            'nbr_panel': 2,
            'colorbar': dict_colorbar['SST'],
            'label': dict_label['SST'],
            "maskland": True,
            'title': ['Mean SST', 'Mean SST'],
            'varpattern': 'sst_map__',
            'xname': 'longitude',
            'yname': 'latitude',
            'zname': 'SST',
        },
    },
    'BiasSstLonRmse': {
        'netcdf_variables': ['sst_lon__', 'sst_map__'],
        'diagnostic': {
            'plot_type': 'curve',
            'nbr_panel': 1,
            'title': 'Mean SST',
            'varpattern': 'sst_lon__',
            'xname': 'longitude',
            'yname': 'SST',
        },
        'dive_down01': {
            'plot_type': 'map',
            'nbr_panel': 2,
            'colorbar': dict_colorbar['SST'],
            'label': dict_label['SST'],
            "maskland": True,
            'title': ['Mean SST', 'Mean SST'],
            'varpattern': 'sst_map__',
            'xname': 'longitude',
            'yname': 'latitude',
            'zname': 'SST',
        },
    },
    'BiasSstRmse': {
        'netcdf_variables': ['sst_map__'],
        'diagnostic': {
            'plot_type': 'map',
            'nbr_panel': 2,
            'colorbar': dict_colorbar['SST'],
            'label': dict_label['SST'],
            "maskland": True,
            'title': ['Mean SST', 'Mean SST'],
            'varpattern': 'sst_map__',
            'xname': 'longitude',
            'yname': 'latitude',
            'zname': 'SST',
        },
    },
    'BiasTauxLatRmse': {
        'netcdf_variables': ['taux_lat__', 'taux_map__'],
        'diagnostic': {
            'plot_type': 'curve',
            'nbr_panel': 1,
            'title': 'Mean TAUX',
            'varpattern': 'taux_lat__',
            'xname': 'latitude',
            'yname': 'TAUX',
        },
        'dive_down01': {
            'plot_type': 'map',
            'nbr_panel': 2,
            'colorbar': dict_colorbar['anomalies'],
            'label': dict_label['TAUX'],
            "maskland": True,
            'title': ['Mean TAUX', 'Mean TAUX'],
            'varpattern': 'taux_map__',
            'xname': 'longitude',
            'yname': 'latitude',
            'zname': 'TAUX',
        },
    },
    'BiasTauxLonRmse': {
        'netcdf_variables': ['taux_lon__', 'taux_map__'],
        'diagnostic': {
            'plot_type': 'curve',
            'nbr_panel': 1,
            'title': 'Mean TAUX',
            'varpattern': 'taux_lon__',
            'xname': 'longitude',
            'yname': 'TAUX',
        },
        'dive_down01': {
            'plot_type': 'map',
            'nbr_panel': 2,
            'colorbar': dict_colorbar['anomalies'],
            'label': dict_label['TAUX'],
            "maskland": True,
            'title': ['Mean TAUX', 'Mean TAUX'],
            'varpattern': 'taux_map__',
            'xname': 'longitude',
            'yname': 'latitude',
            'zname': 'TAUX',
        },
    },
    'BiasTauxRmse': {
        'netcdf_variables': ['taux_map__'],
        'diagnostic': {
            'plot_type': 'map',
            'nbr_panel': 2,
            'colorbar': dict_colorbar['anomalies'],
            'label': dict_label['TAUX'],
            "maskland": True,
            'title': ['Mean TAUX', 'Mean TAUX'],
            'varpattern': 'taux_map__',
            'xname': 'longitude',
            'yname': 'latitude',
            'zname': 'TAUX',
        },
    },
    'EnsoAmpl': {
        'netcdf_variables': ['sstStd_lon__', 'sstStd_map__'],
        'diagnostic': {
            'plot_type': 'dot',
            'nbr_panel': 1,
            'title': 'ENSO amplitude',
            'varpattern': 'diagnostic',
            'yname': 'SSTA std',
        },
        'dive_down01': {
            'plot_type': 'curve',
            'nbr_panel': 1,
            'title': 'SSTA standard deviation',
            'varpattern': 'sstStd_lon__',
            'xname': 'longitude',
            'yname': 'SSTA std',
        },
        'dive_down02': {
            'plot_type': 'map',
            'nbr_panel': 2,
            'colorbar': dict_colorbar['amplitude'],
            'label': dict_label['amplitude'],
            "maskland": True,
            'title': ['SSTA standard deviation', 'SSTA standard deviation'],
            'varpattern': 'sstStd_map__',
            'xname': 'longitude',
            'yname': 'latitude',
            'zname': 'SSTA std',
        },
    },
    'EnsodSstOce': {
        'netcdf_variables': ['dSST_ts__', 'dSSTthf_ts__', 'dSSToce_ts__', 'dSSTthf_lon__', 'dSSToce_lon__',
                             'dSST_hov__', 'dSSTthf_hov__', 'dSSToce_hov__'],
        'diagnostic': {
            'plot_type': 'dot',
            'nbr_panel': 1,
            'title': 'ENSO ocean-driven SST change',
            'varpattern': 'diagnostic',
            'yname': 'normalized dSSToce',
        },
        'dive_down01': {
            'plot_type': 'curve',
            'nbr_panel': 1,
            'title': 'ENSO SST change',
            'varpattern': ['dSST_ts__', 'dSSTthf_ts__', 'dSSToce_ts__'],
            'colors': {"model": ["black", "red", "blue"], "reference": ["black", "red", "blue"]},
            'linestyles': {"model": ["-", "-", "-"], "reference": ["-.", "-.", "-."]},
            'legend': ['dSST', 'dSSTthf', 'dSSToce'],
            'xname': 'months',
            'yname': 'normalized dSST',
        },
        'dive_down02': {
            'plot_type': 'curve',
            'nbr_panel': 1,
            'title': 'ENSO SST change',
            'varpattern': ['dSSTthf_lon__', 'dSSToce_lon__'],
            'colors': {"model": ["red", "blue"], "reference": ["red", "blue"]},
            'linestyles': {"model": ["-", "-"], "reference": ["-.", "-."]},
            'legend': ['dSSTthf', 'dSSToce'],
            'xname': 'longitude',
            'yname': 'normalized dSST',
        },
        'dive_down03': {
            'plot_type': 'hovmoeller',
            'nbr_panel': 6,
            'colorbar': dict_colorbar['anomalies'],
            'label': dict_label['dSST'],
            'title': ['ENSO dSST', 'ENSO heat flux dSST', 'ENSO ocean dSST'],
            'varpattern': ['dSST_hov__', 'dSSTthf_hov__', 'dSSToce_hov__'],
            'xname': 'longitude',
            'yname': 'months',
            'zname': 'normalized dSST',
        },

    },
    'EnsoDuration': {
        'netcdf_variables': ["sst_against_sst_ts__", 'Nina_duration__', 'Nino_duration__'],#['sst_over_sst_ts__', 'Nina_duration__', 'Nino_duration__'],
        'diagnostic': {
            'plot_type': 'dot',
            'nbr_panel': 1,
            'title': 'ENSO duration',
            'varpattern': 'diagnostic',
            'yname': 'duration (reg>0)',
        },
        'dive_down01': {
            'plot_type': 'curve',
            'nbr_panel': 1,
            'title': 'ENSO life-cycle',
            'varpattern': "sst_against_sst_ts__", #'sst_over_sst_ts__',
            'xname': 'months',
            'yname': 'reg(SSTA, SSTA)',
        },
        'dive_down02': {
            'plot_type': 'boxplot',
            'nbr_panel': 2,
            'title': ['La Nina duration', 'El Nino duration'],
            'varpattern': ['Nina_duration__', 'Nino_duration__'],
            'yname': ['duration (SSTA<-0.5)', 'duration (SSTA>0.5)'],
        },
    },
    'EnsoFbSshSst': {
        'netcdf_variables': ['ssh__', 'sst__', 'ssh_over_sst_lon__', 'sshPOS_over_sst_lon__', 'sshNEG_over_sst_lon__',
                             'ssh_over_sst_hov__', 'sshPOS_over_sst_hov__', 'sshNEG_over_sst_hov__'],
        'diagnostic': {
            'plot_type': 'scatterplot',
            'nbr_panel': 1,
            'title': 'Thermocline feedback',
            'varpattern': ['ssh__', 'sst__'],
            'xname': 'SSHA',
            'yname': 'SSTA',
        },
        'dive_down01': {
            'plot_type': 'scatterplot',
            'nbr_panel': 2,
            'title': 'nonlinarity',
            'varpattern': ['ssh__', 'sst__'],
            'xname': 'SSHA',
            'yname': 'SSTA',
        },
        'dive_down02': {
            'plot_type': 'curve',
            'nbr_panel': 1,
            'title': 'Thermocline feedback',
            #'varpattern': ['ssh_over_sst_lon__', 'sshPOS_over_sst_lon__', 'sshNEG_over_sst_lon__'],
            'varpattern': ['reg_sst_over_ssh_lon__', 'reg_sst_over_POSssh_lon__', 'reg_sst_over_NEGssh_lon__'],
            'colors': {"model": ["black", "red", "blue"], "reference": ["black", "red", "blue"]},
            'linestyles': {"model": ["-", "-", "-"], "reference": ["-.", "-.", "-."]},
            'legend': ['All', 'SSHA>0', 'SSHA<0'],
            'xname': 'longitude',
            'yname': 'reg(SSHA, SSTA)',
        },
        'dive_down03': {
            'plot_type': 'hovmoeller',
            'nbr_panel': 6,
            'colorbar': dict_colorbar['anomalies'],
            'label': dict_label['REG03'],
            'title': ['reg(SSHA, SSTA)', 'reg(SSHA>0, SSTA)', 'reg(SSHA<0, SSTA)'],
            #'varpattern': ['ssh_over_sst_hov__', 'sshPOS_over_sst_hov__', 'sshNEG_over_sst_hov__'],
            'varpattern': ['reg_sst_over_ssh_hov__', 'reg_sst_over_POSssh_hov__', 'reg_sst_over_NEGssh_hov__'],
            'xname': 'longitude',
            'yname': 'months',
            'zname': 'regression',
        },
    },
    'EnsoFbSstLhf': {
        'netcdf_variables': ['sst__', 'lhf__', 'sst_over_lhf_lon__', 'sstPOS_over_lhf_lon__', 'sstNEG_over_lhf_lon__',
                             'sst_over_lhf_hov__', 'sstPOS_over_lhf_hov__', 'sstNEG_over_lhf_hov__'],
        'diagnostic': {
            'plot_type': 'scatterplot',
            'nbr_panel': 1,
            'title': 'Latent heat feedback',
            'varpattern': ['sst__', 'lhf__'],
            'xname': 'SSTA',
            'yname': 'LHFA',
        },
        'dive_down01': {
            'plot_type': 'scatterplot',
            'nbr_panel': 2,
            'title': 'nonlinarity',
            'varpattern': ['sst__', 'lhf__'],
            'xname': 'SSTA',
            'yname': 'LHFA',
        },
        'dive_down02': {
            'plot_type': 'curve',
            'nbr_panel': 1,
            'title': 'Latent heat feedback',
            #'varpattern': ['sst_over_lhf_lon__', 'sstPOS_over_lhf_lon__', 'sstNEG_over_lhf_lon__'],
            'varpattern': ['reg_lhf_over_sst_lon__', 'reg_lhf_over_POSsst_lon__', 'reg_lhf_over_NEGsst_lon__'],
            'colors': {"model": ["black", "red", "blue"], "reference": ["black", "red", "blue"]},
            'linestyles': {"model": ["-", "-", "-"], "reference": ["-.", "-.", "-."]},
            'legend': ['All', 'SSTA>0', 'SSTA<0'],
            'xname': 'longitude',
            'yname': 'reg(SSTA, LHFA)',
        },
        'dive_down03': {
            'plot_type': 'hovmoeller',
            'nbr_panel': 6,
            'colorbar': dict_colorbar['anomalies'],
            'label': dict_label['REG20'],
            'title': ['reg(SSTA, LHFA)', 'reg(SSTA>0, LHFA)', 'reg(SSTA<0, LHFA)'],
            #'varpattern': ['sst_over_lhf_hov__', 'sstPOS_over_lhf_hov__', 'sstNEG_over_lhf_hov__'],
            'varpattern': ['reg_lhf_over_sst_hov__', 'reg_lhf_over_POSsst_hov__', 'reg_lhf_over_NEGsst_hov__'],
            'xname': 'longitude',
            'yname': 'months',
            'zname': 'regression',
        },
    },
    'EnsoFbSstLwr': {
        'netcdf_variables': ['sst__', 'lwr__', 'sst_over_lwr_lon__', 'sstPOS_over_lwr_lon__', 'sstNEG_over_lwr_lon__',
                             'sst_over_lwr_hov__', 'sstPOS_over_lwr_hov__', 'sstNEG_over_lwr_hov__'],
        'diagnostic': {
            'plot_type': 'scatterplot',
            'nbr_panel': 1,
            'title': 'Longwave feedback',
            'varpattern': ['sst__', 'lwr__'],
            'xname': 'SSTA',
            'yname': 'LWRA',
        },
        'dive_down01': {
            'plot_type': 'scatterplot',
            'nbr_panel': 2,
            'title': 'nonlinarity',
            'varpattern': ['sst__', 'lwr__'],
            'xname': 'SSTA',
            'yname': 'LWRA',
        },
        'dive_down02': {
            'plot_type': 'curve',
            'nbr_panel': 1,
            'title': 'Longwave feedback',
            #'varpattern': ['sst_over_lwr_lon__', 'sstPOS_over_lwr_lon__', 'sstNEG_over_lwr_lon__'],
            'varpattern': ['reg_lwr_over_sst_lon__', 'reg_lwr_over_POSsst_lon__', 'reg_lwr_over_NEGsst_lon__'],
            'colors': {"model": ["black", "red", "blue"], "reference": ["black", "red", "blue"]},
            'linestyles': {"model": ["-", "-", "-"], "reference": ["-.", "-.", "-."]},
            'legend': ['All', 'SSTA>0', 'SSTA<0'],
            'xname': 'longitude',
            'yname': 'reg(SSTA, LWRA)',
        },
        'dive_down03': {
            'plot_type': 'hovmoeller',
            'nbr_panel': 6,
            'colorbar': dict_colorbar['anomalies'],
            'label': dict_label['REG20'],
            'title': ['reg(SSTA, LWRA)', 'reg(SSTA>0, LWRA)', 'reg(SSTA<0, LWRA)'],
            #'varpattern': ['sst_over_lwr_hov__', 'sstPOS_over_lwr_hov__', 'sstNEG_over_lwr_hov__'],
            'varpattern': ['reg_lwr_over_sst_hov__', 'reg_lwr_over_POSsst_hov__', 'reg_lwr_over_NEGsst_hov__'],
            'xname': 'longitude',
            'yname': 'months',
            'zname': 'regression',
        },
    },
    'EnsoFbSstShf': {
        'netcdf_variables': ['sst__', 'shf__', 'sst_over_shf_lon__', 'sstPOS_over_shf_lon__', 'sstNEG_over_shf_lon__',
                             'sst_over_shf_hov__', 'sstPOS_over_shf_hov__', 'sstNEG_over_shf_hov__'],
        'diagnostic': {
            'plot_type': 'scatterplot',
            'nbr_panel': 1,
            'title': 'Sensible heat feedback',
            'varpattern': ['sst__', 'shf__'],
            'xname': 'SSTA',
            'yname': 'SHFA',
        },
        'dive_down01': {
            'plot_type': 'scatterplot',
            'nbr_panel': 2,
            'title': 'nonlinarity',
            'varpattern': ['sst__', 'shf__'],
            'xname': 'SSTA',
            'yname': 'SHFA',
        },
        'dive_down02': {
            'plot_type': 'curve',
            'nbr_panel': 1,
            'title': 'Sensible heat feedback',
            #'varpattern': ['sst_over_shf_lon__', 'sstPOS_over_shf_lon__', 'sstNEG_over_shf_lon__'],
            'varpattern': ['reg_shf_over_sst_lon__', 'reg_shf_over_POSsst_lon__', 'reg_shf_over_NEGsst_lon__'],
            'colors': {"model": ["black", "red", "blue"], "reference": ["black", "red", "blue"]},
            'linestyles': {"model": ["-", "-", "-"], "reference": ["-.", "-.", "-."]},
            'legend': ['All', 'SSTA>0', 'SSTA<0'],
            'xname': 'longitude',
            'yname': 'reg(SSTA, SHFA)',
        },
        'dive_down03': {
            'plot_type': 'hovmoeller',
            'nbr_panel': 6,
            'colorbar': dict_colorbar['anomalies'],
            'label': dict_label['REG5'],
            'title': ['reg(SSTA, SHFA)', 'reg(SSTA>0, SHFA)', 'reg(SSTA<0, SHFA)'],
            #'varpattern': ['sst_over_shf_hov__', 'sstPOS_over_shf_hov__', 'sstNEG_over_shf_hov__'],
            'varpattern': ['reg_shf_over_sst_hov__', 'reg_shf_over_POSsst_hov__', 'reg_shf_over_NEGsst_hov__'],
            'xname': 'longitude',
            'yname': 'months',
            'zname': 'regression',
        },
    },
    'EnsoFbSstSwr': {
        'netcdf_variables': ['sst__', 'swr__', 'sst_over_swr_lon__', 'sstPOS_over_swr_lon__', 'sstNEG_over_swr_lon__',
                             'sst_over_swr_hov__', 'sstPOS_over_swr_hov__', 'sstNEG_over_swr_hov__'],
        'diagnostic': {
            'plot_type': 'scatterplot',
            'nbr_panel': 1,
            'title': 'Shortwave feedback',
            'varpattern': ['sst__', 'swr__'],
            'xname': 'SSTA',
            'yname': 'SWRA',
        },
        'dive_down01': {
            'plot_type': 'scatterplot',
            'nbr_panel': 2,
            'title': 'nonlinarity',
            'varpattern': ['sst__', 'swr__'],
            'xname': 'SSTA',
            'yname': 'SWRA',
        },
        'dive_down02': {
            'plot_type': 'curve',
            'nbr_panel': 1,
            'title': 'Shortwave feedback',
            #'varpattern': ['sst_over_swr_lon__', 'sstPOS_over_swr_lon__', 'sstNEG_over_swr_lon__'],
            'varpattern': ['reg_swr_over_sst_lon__', 'reg_swr_over_POSsst_lon__', 'reg_swr_over_NEGsst_lon__'],
            'colors': {"model": ["black", "red", "blue"], "reference": ["black", "red", "blue"]},
            'linestyles': {"model": ["-", "-", "-"], "reference": ["-.", "-.", "-."]},
            'legend': ['All', 'SSTA>0', 'SSTA<0'],
            'xname': 'longitude',
            'yname': 'reg(SSTA, SWRA)',
        },
        'dive_down03': {
            'plot_type': 'hovmoeller',
            'nbr_panel': 6,
            'colorbar': dict_colorbar['anomalies'],
            'label': dict_label['REG50'],
            'title': ['reg(SSTA, SWRA)', 'reg(SSTA>0, SWRA)', 'reg(SSTA<0, SWRA)'],
            #'varpattern': ['sst_over_swr_hov__', 'sstPOS_over_swr_hov__', 'sstNEG_over_swr_hov__'],
            'varpattern': ['reg_swr_over_sst_hov__', 'reg_swr_over_POSsst_hov__', 'reg_swr_over_NEGsst_hov__'],
            'xname': 'longitude',
            'yname': 'months',
            'zname': 'regression',
        },
    },
    'EnsoFbSstTaux': {
        'netcdf_variables': [
            'sst__', 'taux__', 'sst_over_taux_lon__', 'sstPOS_over_taux_lon__', 'sstNEG_over_taux_lon__',
            'sst_over_taux_hov__', 'sstPOS_over_taux_hov__', 'sstNEG_over_taux_hov__'],
        'diagnostic': {
            'plot_type': 'scatterplot',
            'nbr_panel': 1,
            'title': 'Wind-SST feedback',
            'varpattern': ['sst__', 'taux__'],
            'xname': 'SSTA',
            'yname': 'TAUXA',
        },
        'dive_down01': {
            'plot_type': 'scatterplot',
            'nbr_panel': 2,
            'title': 'nonlinarity',
            'varpattern': ['sst__', 'taux__'],
            'xname': 'SSTA',
            'yname': 'TAUXA',
        },
        'dive_down02': {
            'plot_type': 'curve',
            'nbr_panel': 1,
            'title': 'Wind-SST feedback',
            #'varpattern': ['sst_over_taux_lon__', 'sstPOS_over_taux_lon__', 'sstNEG_over_taux_lon__'],
            'varpattern': ['reg_taux_over_sst_lon__', 'reg_taux_over_POSsst_lon__', 'reg_taux_over_NEGsst_lon__'],
            'colors': {"model": ["black", "red", "blue"], "reference": ["black", "red", "blue"]},
            'linestyles': {"model": ["-", "-", "-"], "reference": ["-.", "-.", "-."]},
            'legend': ['All', 'SSTA>0', 'SSTA<0'],
            'xname': 'longitude',
            'yname': 'reg(SSTA, TAUXA)',
        },
        'dive_down03': {
            'plot_type': 'hovmoeller',
            'nbr_panel': 6,
            'colorbar': dict_colorbar['anomalies'],
            'label': dict_label['REG20'],
            'title': ['reg(SSTA, TAUXA)', 'reg(SSTA>0, TAUXA)', 'reg(SSTA<0, TAUXA)'],
            #'varpattern': ['sst_over_taux_hov__', 'sstPOS_over_taux_hov__', 'sstNEG_over_taux_hov__'],
            'varpattern': ['reg_taux_over_sst_hov__', 'reg_taux_over_POSsst_hov__', 'reg_taux_over_NEGsst_hov__'],
            'xname': 'longitude',
            'yname': 'months',
            'zname': 'regression',
        },
    },
    'EnsoFbSstThf': {
        'netcdf_variables': ['sst__', 'thf__', 'sst_over_thf_lon__', 'sstPOS_over_thf_lon__', 'sstNEG_over_thf_lon__',
                             'sst_over_thf_hov__', 'sstPOS_over_thf_hov__', 'sstNEG_over_thf_hov__'],
        'diagnostic': {
            'plot_type': 'scatterplot',
            'nbr_panel': 1,
            'title': 'Total heat feedback',
            'varpattern': ['sst__', 'thf__'],
            'xname': 'SSTA',
            'yname': 'THFA',
        },
        'dive_down01': {
            'plot_type': 'scatterplot',
            'nbr_panel': 2,
            'title': 'nonlinarity',
            'varpattern': ['sst__', 'thf__'],
            'xname': 'SSTA',
            'yname': 'THFA',
        },
        'dive_down02': {
            'plot_type': 'curve',
            'nbr_panel': 1,
            'title': 'Total heat feedback',
            #'varpattern': ['sst_over_thf_lon__', 'sstPOS_over_thf_lon__', 'sstNEG_over_thf_lon__'],
            'varpattern': ['reg_thf_over_sst_lon__', 'reg_thf_over_POSsst_lon__', 'reg_thf_over_NEGsst_lon__'],
            'colors': {"model": ["black", "red", "blue"], "reference": ["black", "red", "blue"]},
            'linestyles': {"model": ["-", "-", "-"], "reference": ["-.", "-.", "-."]},
            'legend': ['All', 'SSTA>0', 'SSTA<0'],
            'xname': 'longitude',
            'yname': 'reg(SSTA, THFA)',
        },
        'dive_down03': {
            'plot_type': 'hovmoeller',
            'nbr_panel': 6,
            'colorbar': dict_colorbar['anomalies'],
            'label': dict_label['REG50'],
            'title': ['reg(SSTA, THFA)', 'reg(SSTA>0, THFA)', 'reg(SSTA<0, THFA)'],
            #'varpattern': ['sst_over_thf_hov__', 'sstPOS_over_thf_hov__', 'sstNEG_over_thf_hov__'],
            'varpattern': ['reg_thf_over_sst_hov__', 'reg_thf_over_POSsst_hov__', 'reg_thf_over_NEGsst_hov__'],
            'xname': 'longitude',
            'yname': 'months',
            'zname': 'regression',
        },
    },
    'EnsoFbTauxSsh': {
        'netcdf_variables': ['taux__', 'ssh__', 'taux_over_ssh_lon__', 'tauxPOS_over_ssh_lon__', 'tauxNEG_over_ssh_lon__',
                             'taux_over_ssh_hov__', 'tauxPOS_over_ssh_hov__', 'tauxNEG_over_ssh_hov__'],
        'diagnostic': {
            'plot_type': 'scatterplot',
            'nbr_panel': 1,
            'title': 'SSH-Wind feedback',
            'varpattern': ['taux__', 'ssh__'],
            'xname': 'TAUXA',
            'yname': 'SSHA',
        },
        'dive_down01': {
            'plot_type': 'scatterplot',
            'nbr_panel': 2,
            'title': 'nonlinarity',
            'varpattern': ['taux__', 'ssh__'],
            'xname': 'TAUXA',
            'yname': 'SSHA',
        },
        'dive_down02': {
            'plot_type': 'curve',
            'nbr_panel': 1,
            'title': 'SSH-Wind feedback',
            #'varpattern': ['taux_over_ssh_lon__', 'tauxPOS_over_ssh_lon__', 'tauxNEG_over_ssh_lon__'],
            'varpattern': ['reg_ssh_over_taux_lon__', 'reg_ssh_over_POStaux_lon__', 'reg_ssh_over_NEGtaux_lon__'],
            'colors': {"model": ["black", "red", "blue"], "reference": ["black", "red", "blue"]},
            'linestyles': {"model": ["-", "-", "-"], "reference": ["-.", "-.", "-."]},
            'legend': ['All', 'TAUXA>0', 'TAUXA<0'],
            'xname': 'longitude',
            'yname': 'reg(TAUXA, SSHA)',
        },
        'dive_down03': {
            'plot_type': 'hovmoeller',
            'nbr_panel': 6,
            'colorbar': dict_colorbar['anomalies'],
            'label': dict_label['REG05'],
            'title': ['reg(TAUXA, SSHA)', 'reg(TAUXA>0, SSHA)', 'reg(TAUXA<0, SSHA)'],
            #'varpattern': ['taux_over_ssh_hov__', 'tauxPOS_over_ssh_hov__', 'tauxNEG_over_ssh_hov__'],
            'varpattern': ['reg_ssh_over_taux_hov__', 'reg_ssh_over_POStaux_hov__', 'reg_ssh_over_NEGtaux_hov__'],
            'xname': 'longitude',
            'yname': 'months',
            'zname': 'regression',
        },
    },
    'EnsoPrTsRmse': {
        'netcdf_variables': ['pr_over_sst_ts__', 'pr_over_sst_hov__', 'Nina_pr_ts__', 'Nino_pr_ts__', 'Nina_pr_hov__',
                             'Nino_pr_hov__'],
        'diagnostic': {
            'plot_type': 'curve',
            'nbr_panel': 1,
            'title': "ENSO's PRA life-cycle",
            #'varpattern': 'pr_over_sst_ts__',
            'varpattern': 'sst_against_pr_ts__',
            'xname': 'months',
            'yname': 'reg(ENSO SSTA, PRA)',
        },
        'dive_down01': {
            'plot_type': 'hovmoeller',
            'nbr_panel': 2,
            'colorbar': dict_colorbar['anomalies'],
            'label': dict_label['REG3'],
            'title': ['reg(ENSO SSTA, PRA)', 'reg(ENSO SSTA, PRA)'],
            #'varpattern': 'pr_over_sst_hov__',
            'varpattern': 'sst_against_pr_hov__',
            'xname': 'longitude',
            'yname': 'months',
            'zname': 'regression',
        },
        'dive_down02': {
            'plot_type': 'curve',
            'nbr_panel': 1,
            'title': "ENSO's PRA life-cycle",
            'varpattern': ['Nina_pr_ts__', 'Nino_pr_ts__'],
            'colors': {"model": ["blue", "red"], "reference": ["blue", "red"]},
            'linestyles': {"model": ["-", "-"], "reference": ["-.", "-."]},
            'legend': ['La Nina', 'El Nino'],
            'xname': 'months',
            'yname': 'ENSO PRA',
        },
        'dive_down03': {
            'plot_type': 'hovmoeller',
            'nbr_panel': 4,
            'colorbar': dict_colorbar['anomalies'],
            'label': dict_label['REG5'],
            'title': ['La Nina PRA', 'El Nino PRA'],
            'varpattern': ['Nina_pr_hov__', 'Nino_pr_hov__'],
            'xname': 'longitude',
            'yname': 'months',
            'zname': 'PRA',
        },
    },
    'EnsoSstLonRmse': {
        'netcdf_variables': ['sst_over_sst_lon__', 'sst_over_sst_map__', 'Nina_sst_lon__', 'Nino_sst_lon__',
                             'Nina_sst_map__', 'Nino_sst_map__'],
        'diagnostic': {
            'plot_type': 'curve',
            'nbr_panel': 1,
            'title': "ENSO pattern",
            #'varpattern': 'sst_over_sst_lon__',
            'varpattern': 'sst_against_sst_lon__',
            'xname': 'longitude',
            'yname': 'reg(ENSO SSTA, SSTA)',
        },
        'dive_down01': {
            'plot_type': 'map',
            'nbr_panel': 2,
            'colorbar': dict_colorbar['anomalies'],
            'label': dict_label['SKEW'],
            "maskland": True,
            'title': ['reg(ENSO SSTA, SSTA)', 'reg(ENSO SSTA, SSTA)'],
            #'varpattern': 'sst_over_sst_map__',
            'varpattern': 'sst_against_sst_map__',
            'xname': 'longitude',
            'yname': 'latitude',
            'zname': 'regression',
        },
        'dive_down02': {
            'plot_type': 'curve',
            'nbr_panel': 1,
            'title': "ENSO's SSTA pattern",
            'varpattern': ['Nina_sst_lon__', 'Nino_sst_lon__'],
            'colors': {"model": ["blue", "red"], "reference": ["blue", "red"]},
            'linestyles': {"model": ["-", "-"], "reference": ["-.", "-."]},
            'legend': ['La Nina', 'El Nino'],
            'xname': 'longitude',
            'yname': 'ENSO SSTA',
        },
        'dive_down03': {
            'plot_type': 'map',
            'nbr_panel': 4,
            'colorbar': dict_colorbar['anomalies'],
            'label': dict_label['REG25'],
            "maskland": True,
            'title': ['La Nina SSTA', 'El Nino SSTA'],
            'varpattern': ['Nina_sst_map__', 'Nino_sst_map__'],
            'xname': 'longitude',
            'yname': 'latitude',
            'zname': 'SSTA',
        },
    },
    'EnsoSstMap': {
        'netcdf_variables': ['ts_over_sst_map__'],
        'diagnostic': {
            'plot_type': 'map',
            'nbr_panel': 2,
            'colorbar': dict_colorbar['anomalies'],
            'label': dict_label['SKEW'],
            "maskland": True,
            'title': ['reg(ENSO SSTA, TSA)', 'reg(ENSO SSTA, TSA)'],
            #'varpattern': 'ts_over_sst_map__',
            'varpattern': 'reg_ts_over_sst_map__',
            'xname': 'longitude',
            'yname': 'latitude',
            'zname': 'regression',
        },
    },
    'EnsoSstTsRmse': {
        'netcdf_variables': ['sst_over_sst_ts__', 'sst_over_sst_hov__', 'Nina_sst_ts__', 'Nino_sst_ts__',
                             'Nina_sst_hov__', 'Nino_sst_hov__'],
        'diagnostic': {
            'plot_type': 'curve',
            'nbr_panel': 1,
            'title': "ENSO life-cycle",
            #'varpattern': 'sst_over_sst_ts__',
            'varpattern': 'sst_against_sst_ts__',
            'xname': 'months',
            'yname': 'reg(ENSO SSTA, SSTA)',
        },
        'dive_down01': {
            'plot_type': 'hovmoeller',
            'nbr_panel': 2,
            'colorbar': dict_colorbar['anomalies'],
            'label': dict_label['REG12'],
            'title': ['reg(ENSO SSTA, SSTA)', 'reg(ENSO SSTA, SSTA)'],
            #'varpattern': 'sst_over_sst_hov__',
            'varpattern': 'sst_against_sst_hov__',
            'xname': 'longitude',
            'yname': 'months',
            'zname': 'regression',
        },
        'dive_down02': {
            'plot_type': 'curve',
            'nbr_panel': 1,
            'title': "ENSO's SSTA life-cycle",
            'varpattern': ['Nina_sst_ts__', 'Nino_sst_ts__'],
            'colors': {"model": ["blue", "red"], "reference": ["blue", "red"]},
            'linestyles': {"model": ["-", "-"], "reference": ["-.", "-."]},
            'legend': ['La Nina', 'El Nino'],
            'xname': 'months',
            'yname': 'ENSO SSTA',
        },
        'dive_down03': {
            'plot_type': 'hovmoeller',
            'nbr_panel': 4,
            'colorbar': dict_colorbar['anomalies'],
            'label': dict_label['REG2'],
            'title': ['La Nina SSTA', 'El Nino SSTA'],
            'varpattern': ['Nina_sst_hov__', 'Nino_sst_hov__'],
            'xname': 'longitude',
            'yname': 'months',
            'zname': 'SSTA',
        },
    },
    'EnsoTauxTsRmse': {
        'netcdf_variables': ['taux_over_sst_ts__', 'taux_over_sst_hov__', 'Nina_taux_ts__', 'Nino_taux_ts__',
                             'Nina_taux_hov__', 'Nino_taux_hov__'],
        'diagnostic': {
            'plot_type': 'curve',
            'nbr_panel': 1,
            'title': "ENSO life-cycle",
            #'varpattern': 'taux_over_sst_ts__',
            'varpattern': 'sst_against_taux_ts__',
            'xname': 'months',
            'yname': 'reg(ENSO SSTA, TAUXA)',
        },
        'dive_down01': {
            'plot_type': 'hovmoeller',
            'nbr_panel': 2,
            'colorbar': dict_colorbar['anomalies'],
            'label': dict_label['REG20'],
            'title': ['reg(ENSO SSTA, TAUXA)', 'reg(ENSO SSTA, TAUXA)'],
            #'varpattern': 'taux_over_sst_hov__',
            'varpattern': 'sst_against_taux_hov__',
            'xname': 'longitude',
            'yname': 'months',
            'zname': 'regression',
        },
        'dive_down02': {
            'plot_type': 'curve',
            'nbr_panel': 1,
            'title': "ENSO's TAUXA life-cycle",
            'varpattern': ['Nina_taux_ts__', 'Nino_taux_ts__'],
            'colors': {"model": ["blue", "red"], "reference": ["blue", "red"]},
            'linestyles': {"model": ["-", "-"], "reference": ["-.", "-."]},
            'legend': ['La Nina', 'El Nino'],
            'xname': 'months',
            'yname': 'ENSO TAUXA',
        },
        'dive_down03': {
            'plot_type': 'hovmoeller',
            'nbr_panel': 4,
            'colorbar': dict_colorbar['anomalies'],
            'label': dict_label['REG30'],
            'title': ['La Nina TAUXA', 'El Nino TAUXA'],
            'varpattern': ['Nina_taux_hov__', 'Nino_taux_hov__'],
            'xname': 'longitude',
            'yname': 'months',
            'zname': 'SSTA',
        },
    },
    'EnsoSeasonality': {
        'netcdf_variables': ['sstStd_monthly__', 'sstStd_hov__', 'sstStd_NDJ_lon__', 'sstStd_MAM_lon__',
                             "sstStd_NDJ_map__", "sstStd_MAM_map__"],
        'diagnostic': {
            'plot_type': 'dot',
            'nbr_panel': 1,
            'title': 'ENSO Seasonality',
            'varpattern': 'diagnostic',
            'yname': 'SSTA std (NDJ/MAM)',
        },
        'dive_down01': {
            'plot_type': 'curve',
            'nbr_panel': 1,
            'title': 'SSTA standard deviation',
            'varpattern': 'sstStd_monthly__',
            'xname': 'months',
            'yname': 'SSTA std',
        },
        'dive_down02': {
            'plot_type': 'hovmoeller',
            'nbr_panel': 2,
            'colorbar': dict_colorbar['amplitude'],
            'label': dict_label['amplitude'],
            'title': ['SSTA standard deviation', 'SSTA standard deviation'],
            'varpattern': 'sstStd_hov__',
            'xname': 'longitude',
            'yname': 'months',
            'zname': 'SSTA std',
        },
        'dive_down03': {
            'plot_type': "curve",
            'nbr_panel': 1,
            'title': "SSTA standard deviation",
            'varpattern': ['sstStd_NDJ_lon__', 'sstStd_MAM_lon__'],
            'colors': {"model": ["red", "blue"], "reference": ["red", "blue"]},
            'linestyles': {"model": ["-", "-"], "reference": ["-.", "-."]},
            'legend': ['NDJ', 'MAM'],
            'xname': 'longitude',
            'yname': 'SSTA std',
        },
        'dive_down04': {
            'plot_type': 'map',
            'nbr_panel': 4,
            'colorbar': dict_colorbar['amplitude'],
            'label': dict_label['amplitude'],
            "maskland": True,
            'title': ['NDJ', 'MAM'], #['SSTA std NDJ', 'SSTA std MAM'],
            'varpattern': ["sstStd_NDJ_map__", "sstStd_MAM_map__"],
            'xname': 'longitude',
            'yname': 'latitude',
            'zname': 'SSTA std',
        },
    },
    'EnsoSstSkew': {
        'netcdf_variables': ['sstSke_lon__', 'sstSke_map__'],
        'diagnostic': {
            'plot_type': 'dot',
            'nbr_panel': 1,
            'title': 'ENSO skewness',
            'varpattern': 'diagnostic',
            'yname': 'SSTA skewness',
        },
        'dive_down01': {
            'plot_type': 'curve',
            'nbr_panel': 1,
            'title': 'SSTA skewness',
            'varpattern': "sstSke_lon__",
            'xname': 'longitude',
            'yname': 'SSTA skew',
        },
        'dive_down02': {
            'plot_type': 'map',
            'nbr_panel': 2,
            'colorbar': dict_colorbar['anomalies'],
            'label': dict_label['SKEW'],
            "maskland": True,
            'title': ['SSTA skew', 'SSTA skew'],
            'varpattern': "sstSke_map__",
            'xname': 'longitude',
            'yname': 'latitude',
            'zname': 'SSTA skew',
        },
    },
    'NinaSstDur': {
        'netcdf_variables': ['Nina_duration__'],
        'diagnostic': {
            'plot_type': 'dot',
            'nbr_panel': 1,
            'title': 'La Nina duration',
            'varpattern': 'diagnostic',
            'yname': 'duration (SSTA<-0.5)',
        },
        'dive_down01': {
            'plot_type': 'boxplot',
            'nbr_panel': 1,
            'title': 'La Nina duration',
            'varpattern': 'Nina_duration__',
            'yname': 'duration (SSTA<-0.5)',
        },
    },
    'NinaSstLonRmse': {
        'netcdf_variables': ['sst_lon__', 'sst_map__'],
        'diagnostic': {
            'plot_type': 'curve',
            'nbr_panel': 1,
            'title': "La Nina pattern",
            'varpattern': 'sst_lon__',
            'xname': 'longitude',
            'yname': 'SSTA',
        },
        'dive_down01': {
            'plot_type': 'map',
            'nbr_panel': 2,
            'colorbar': dict_colorbar['anomalies'],
            'label': dict_label['SKEW'],
            "maskland": True,
            'title': 'La Nina SSTA',
            'varpattern': 'sst_map__',
            'xname': 'longitude',
            'yname': 'latitude',
            'zname': 'SSTA',
        },
    },
    'NinaSstTsRmse': {
        'netcdf_variables': ['sst_ts__', 'sst_hov__'],
        'diagnostic': {
            'plot_type': 'curve',
            'nbr_panel': 1,
            'title': "La Nina life-cycle",
            'varpattern': 'sst_ts__',
            'xname': 'months',
            'yname': 'SSTA',
        },
        'dive_down01': {
            'plot_type': 'hovmoeller',
            'nbr_panel': 2,
            'colorbar': dict_colorbar['anomalies'],
            'label': dict_label['SKEW'],
            'title': 'La Nina SSTA',
            'varpattern': 'sst_hov__',
            'xname': 'longitude',
            'yname': 'months',
            'zname': 'SSTA',
        },
    },
    "NinoSstDiversity": {
        'netcdf_variables': ['Nina_lon_pos_minSSTA__', "Nino_lon_pos_maxSSTA__"],
        'diagnostic': {
            'plot_type': 'dot',
            'nbr_panel': 1,
            'title': 'El Nino diversity',
            'varpattern': 'diagnostic',
            'yname': 'IQR of max SSTA',
        },
        'dive_down01': {
            'plot_type': 'boxplot',
            'nbr_panel': 2,
            'title': ['La Nina diversity', 'El Nino diversity'],
            'varpattern': ['Nina_lon_pos_minSSTA__', 'Nino_lon_pos_maxSSTA__'],
            'yname': ['longitude of min SSTA', 'longitude of max SSTA'],
        },
    },
    'NinoSstDur': {
        'netcdf_variables': ['Nino_duration__'],
        'diagnostic': {
            'plot_type': 'dot',
            'nbr_panel': 1,
            'title': 'El Nino duration',
            'varpattern': 'diagnostic',
            'yname': 'duration (SSTA>0.5)',
        },
        'dive_down01': {
            'plot_type': 'boxplot',
            'nbr_panel': 1,
            'title': 'El Nino duration',
            'varpattern': 'Nino_duration__',
            'yname': 'duration (SSTA>0.5)',
        },
    },
    'NinoSstLonRmse': {
        'netcdf_variables': ['sst_lon__', 'sst_map__'],
        'diagnostic': {
            'plot_type': 'curve',
            'nbr_panel': 1,
            'title': "El Nino pattern",
            'varpattern': 'sst_lon__',
            'xname': 'longitude',
            'yname': 'SSTA',
        },
        'dive_down01': {
            'plot_type': 'map',
            'nbr_panel': 2,
            'colorbar': dict_colorbar['anomalies'],
            'label': dict_label['SKEW'],
            "maskland": True,
            'title': 'El Nino SSTA',
            'varpattern': 'sst_map__',
            'xname': 'longitude',
            'yname': 'latitude',
            'zname': 'SSTA',
        },
    },
    'NinoSstTsRmse': {
        'netcdf_variables': ['sst_ts__', 'sst_hov__'],
        'diagnostic': {
            'plot_type': 'curve',
            'nbr_panel': 1,
            'title': "El Nino life-cycle",
            'varpattern': 'sst_ts__',
            'xname': 'months',
            'yname': 'SSTA',
        },
        'dive_down01': {
            'plot_type': 'hovmoeller',
            'nbr_panel': 2,
            'colorbar': dict_colorbar['anomalies'],
            'label': dict_label['SKEW'],
            'title': 'El Nino SSTA',
            'varpattern': 'sst_hov__',
            'xname': 'longitude',
            'yname': 'months',
            'zname': 'SSTA',
        },
    },
    'SeasonalPrLatRmse': {
        'netcdf_variables': ["pr_lat__", "pr_map__", "prMac_hov__"],
        'diagnostic': {
            'plot_type': 'curve',
            'nbr_panel': 1,
            'title': 'PR seasonal cycle std',
            'varpattern': 'pr_lat__',
            'xname': 'latitude',
            'yname': 'PR std',
        },
        'dive_down01': {
            'plot_type': 'map',
            'nbr_panel': 2,
            'colorbar': dict_colorbar['amplitude'],
            'label': dict_label['amplitude5'],
            "maskland": True,
            'title': ['PR seasonal cycle std'],
            'varpattern': "pr_map__",
            'xname': 'longitude',
            'yname': 'latitude',
            'zname': 'PR std',
        },
        'dive_down02': {
            'plot_type': 'hovmoeller',
            'nbr_panel': 2,
            'colorbar': dict_colorbar['PR'],
            'label': dict_label['amplitude15'],
            'title': ['PR seasonal cycle', 'PR seasonal cycle'],
            'varpattern': 'prMac_hov__',
            'xname': 'latitude',
            'yname': 'months',
            'zname': 'PR',
        },
    },
    'SeasonalPrLonRmse': {
        'netcdf_variables': ["pr_lon__", "pr_map__", "prMac_hov__"],
        'diagnostic': {
            'plot_type': 'curve',
            'nbr_panel': 1,
            'title': 'PR seasonal cycle std',
            'varpattern': 'pr_lon__',
            'xname': 'longitude',
            'yname': 'PR std',
        },
        'dive_down01': {
            'plot_type': 'map',
            'nbr_panel': 2,
            'colorbar': dict_colorbar['amplitude'],
            'label': dict_label['amplitude5'],
            "maskland": True,
            'title': ['PR seasonal cycle std'],
            'varpattern': "pr_map__",
            'xname': 'longitude',
            'yname': 'latitude',
            'zname': 'PR std',
        },
        'dive_down02': {
            'plot_type': 'hovmoeller',
            'nbr_panel': 2,
            'colorbar': dict_colorbar['PR'],
            'label': dict_label['amplitude10'],
            'title': ['PR seasonal cycle', 'PR seasonal cycle'],
            'varpattern': 'prMac_hov__',
            'xname': 'longitude',
            'yname': 'months',
            'zname': 'PR',
        },
    },
    'SeasonalSstLatRmse': {
        'netcdf_variables': ["sst_lat__", "sst_map__", "sstMac_hov__"],
        'diagnostic': {
            'plot_type': 'curve',
            'nbr_panel': 1,
            'title': 'SST seasonal cycle std',
            'varpattern': 'sst_lat__',
            'xname': 'latitude',
            'yname': 'SST std',
        },
        'dive_down01': {
            'plot_type': 'map',
            'nbr_panel': 2,
            'colorbar': dict_colorbar['amplitude'],
            'label': dict_label['amplitude'],
            "maskland": True,
            'title': ['SST seasonal cycle std'],
            'varpattern': "sst_map__",
            'xname': 'longitude',
            'yname': 'latitude',
            'zname': 'SST std',
        },
        'dive_down02': {
            'plot_type': 'hovmoeller',
            'nbr_panel': 2,
            'colorbar': dict_colorbar['SST'],
            'label': dict_label['SST'],
            'title': ['SST seasonal cycle', 'SST seasonal cycle'],
            'varpattern': 'sstMac_hov__',
            'xname': 'latitude',
            'yname': 'months',
            'zname': 'SST',
        },
    },
    'SeasonalSstLonRmse': {
        'netcdf_variables': ["sst_lon__", "sst_map__", "sstMac_hov__"],
        'diagnostic': {
            'plot_type': 'curve',
            'nbr_panel': 1,
            'title': 'SST seasonal cycle std',
            'varpattern': 'sst_lon__',
            'xname': 'longitude',
            'yname': 'SST std',
        },
        'dive_down01': {
            'plot_type': 'map',
            'nbr_panel': 2,
            'colorbar': dict_colorbar['amplitude'],
            'label': dict_label['amplitude'],
            "maskland": True,
            'title': ['SST seasonal cycle std'],
            'varpattern': "sst_map__",
            'xname': 'longitude',
            'yname': 'latitude',
            'zname': 'SST std',
        },
        'dive_down02': {
            'plot_type': 'hovmoeller',
            'nbr_panel': 2,
            'colorbar': dict_colorbar['SST'],
            'label': dict_label['SST'],
            'title': ['SST seasonal cycle', 'SST seasonal cycle'],
            'varpattern': 'sstMac_hov__',
            'xname': 'longitude',
            'yname': 'months',
            'zname': 'SST',
        },
    },
    'SeasonalTauxLatRmse': {
        'netcdf_variables': ["taux_lat__", "taux_map__", "tauxMac_hov__"],
        'diagnostic': {
            'plot_type': 'curve',
            'nbr_panel': 1,
            'title': 'TAUX seasonal cycle std',
            'varpattern': 'taux_lat__',
            'xname': 'latitude',
            'yname': 'TAUX std',
        },
        'dive_down01': {
            'plot_type': 'map',
            'nbr_panel': 2,
            'colorbar': dict_colorbar['amplitude'],
            'label': dict_label['amplitude60'],
            "maskland": True,
            'title': ['TAUX seasonal cycle std'],
            'varpattern': "taux_map__",
            'xname': 'longitude',
            'yname': 'latitude',
            'zname': 'TAUX std',
        },
        'dive_down02': {
            'plot_type': 'hovmoeller',
            'nbr_panel': 2,
            'colorbar': dict_colorbar['anomalies'],
            'label': dict_label['TAUX'],
            'title': ['TAUX seasonal cycle', 'TAUX seasonal cycle'],
            'varpattern': 'tauxMac_hov__',
            'xname': 'latitude',
            'yname': 'months',
            'zname': 'TAUX',
        },
    },
    'SeasonalTauxLonRmse': {
        'netcdf_variables': ["taux_lon__", "taux_map__", "tauxMac_hov__"],
        'diagnostic': {
            'plot_type': 'curve',
            'nbr_panel': 1,
            'title': 'TAUX seasonal cycle std',
            'varpattern': 'taux_lon__',
            'xname': 'longitude',
            'yname': 'TAUX std',
        },
        'dive_down01': {
            'plot_type': 'map',
            'nbr_panel': 2,
            'colorbar': dict_colorbar['amplitude'],
            'label': dict_label['amplitude60'],
            "maskland": True,
            'title': ['TAUX seasonal cycle std'],
            'varpattern': "taux_map__",
            'xname': 'longitude',
            'yname': 'latitude',
            'zname': 'TAUX std',
        },
        'dive_down02': {
            'plot_type': 'hovmoeller',
            'nbr_panel': 2,
            'colorbar': dict_colorbar['anomalies'],
            'label': dict_label['REG80'],
            'title': ['TAUX seasonal cycle', 'TAUX seasonal cycle'],
            'varpattern': 'tauxMac_hov__',
            'xname': 'longitude',
            'yname': 'months',
            'zname': 'TAUX',
        },
    },

}

# reference_observations = {
#     'ssh': 'AVISO', 'pr': 'GPCPv2.3', 'sst': 'HadISST', 'lhf': 'Tropflux', 'lwr': 'Tropflux', 'shf': 'Tropflux',
#     'swr': 'Tropflux', 'taux': 'Tropflux', 'thf': 'Tropflux'
# }
reference_observations = {
    'ssh': 'AVISO', 'pr': 'GPCPv2.3', 'sst': 'Tropflux', 'lhf': 'Tropflux', 'lwr': 'Tropflux', 'shf': 'Tropflux',
    'swr': 'Tropflux', 'taux': 'Tropflux', 'thf': 'Tropflux'
}


def plot_param(metric_collection, metric):
    dict_MC = defCollection(metric_collection)
    dict_MCm = dict_MC['metrics_list'][metric]
    # get plot parameters
    dict_out = plot_parameters[metric.replace("_1", "").replace("_2", "").replace("_3", "")]
    # get metric computation
    if "rmse" in metric.lower():
        computation = "RMSE"
    elif "corr" in metric.lower():
        computation = "CORR"
    else:
        try:
            computation = dict_MCm['metric_computation']
        except:
            try:
                computation = dict_MC['common_collection_parameters']['metric_computation']
            except:
                computation = DefaultArgValues('metric_computation')
    dict_out['metric_computation'] = computation
    # get metric variables
    variables = dict_MCm['variables']
    dict_out['metric_variables'] = variables
    # get metric reference
    references = dict((var, reference_observations[var]) for var in variables)
    if 'sst' in variables and len(variables) > 1:
        references['sst'] = 'Tropflux'
    refname = references[variables[0]]
    for var in variables[1:]:
        refname = refname + "_" + references[var]
    dict_out['metric_reference'] = refname
    # get variable regions
    dict_out['metric_regions'] = dict_MCm['regions']
    return dict_out


    # BiasSstSkLonRmse, EnsoDiversity
    # EnsoPrMap, NinaPrMap, NinoPrMap
    # EnsoSlpMap, NinaSlpMap, NinoSlpMap
    # EnsoSstMap, NinaSstMap, NinoSstMap
    # NinaSstLonRmse, NinoSstLonRmse
    # NinaSstTsRmse, NinoSstTsRmse
    # EnsoPrJjaTel, EnsoPrNdjTel, NinaPrJjaTel, NinaPrNdjTel, NinoPrJjaTel, NinoPrNdjTel
    # NinaSstDiv, NinoSstDiv, NinaSstDivRmse, NinoSstDivRmse
